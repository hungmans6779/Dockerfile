<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="format-detection" content="telephone=no">
    <title>台北富邦銀行 辦卡進度</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/croppie/2.6.5/croppie.css" rel="stylesheet">
    </link>
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
    </link>
    <link rel="icon" href="images/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="css/main.css" />
    <!-- Google Tag Manager -->
    <script>
        (function (w, d, s, l, i) {
            w[l] = w[l] || [];
            w[l].push({
                'gtm.start': new Date().getTime(), event: 'gtm.js'
            });
            var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : '';
            j.async = true;
            j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
            f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-KHWCGTV');
    </script>
    <!-- End Google Tag Manager -->
</head>

<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript>
        <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KHWCGTV" height="0" width="0"
            style="display:none;visibility:hidden">
        </iframe>
    </noscript>
    <!-- End Google Tag Manager (noscript) -->
    <div class="wrapper" id="wrapper">
        <div class="loading">
            <div class="box flexBox">
                Loading
                <span></span>
            </div>
        </div>
        <div class="kv">
            <h1 class="logo">
                <span>台北富邦銀行</span>
                <a href="https://www.fubon.com/banking/personal/index.htm">
                    <img src="images/logo.png" alt="台北富邦銀行">
                </a>
            </h1>
            <div class="kvImg">
                <img src="images/kv-bg.png" alt="" class="pc">
                <img src="images/kv-m.png" alt="" class="mb">
            </div>
            <h3>查詢結果及補件說明</h3>
        </div>
        <div class="main step2">
            <div class="section step2-section-pc pc">
                <div class="title">
                    <div class="item">
                        案件
                    </div>
                    <div class="item">
                        卡片種類
                    </div>
                    <div class="item">
                        卡別
                    </div>
                    <div class="item">
                        申請進度
                    </div>
                    <div class="item">
                        補件方式
                    </div>
                </div>
                <!-- 注意事項pc -->
                <div class="content">
                    <table>
                    </table>
					<!-- 新增財力證明 -->
					<a href="https://mkt.taipeifubon.com.tw/creditcard/costco/index.html#sec6" class="link" target="_blank">
						財力證明需要補件？懶人包看這裡＞
					</a>
                    <div class="list">
                        <h3 class="active" onclick="openList(event)">注意事項<span class="active"><img
                                    src="images/icon/arrow-down.svg" alt=""></span></h3>
                        <div class="item">
                            <p>感謝您申辦本行信用卡，如您尚需補件，請點選「 線上補件」，或依下述說明補件，我們將盡速為您處理。
                                <br>注意事項：
                            </p>
                            <ul>
                                <li>
                                    線上補件：
                                    <ul>
                                        <!-- 新增文字1 '，可分批上傳' -->
										<li>每個檔案上限 6M，每次上傳檔案總和上限 15M，可分批上傳。</li> 
										<li>補件檔案請務必清晰無反光，並勿加密檔案，以免補件失敗。</li>
										<!-- 新增文字2 '(待補資料若為財力證明類，請擇一提供，且文件須顯示本人姓名)' -->
										<li>請依分類【身份證明文件、個人相片、財力證明、基本資料及聯名團體相關資料、其他】逐項上傳補件資料，以利系統判斷是否補件完整。(待補資料若為財力證明類，請擇一提供，且文件須顯示本人姓名)</li>
										<!-- 新增文字3 '系統將於您點選~...' -->
										<li>系統將於您點選【確認上傳】後，進行資料傳送，並將於1~2小時內進行更新案件進度。</li>
										<!-- 新增文字4 '富邦Costco聯名卡~...' -->
										<li>富邦Costco聯名卡之會員相片補件僅能透過本行官網線上上傳，無法透過郵寄等件方式補件。</li>
                                    </ul>
                                </li>
                                <li>
                                    郵寄補件：<br>若您所缺之文件需徵提「補申請人之中文簽名」或「以舊版申請書進件」
                                    ，請務必將申請書（或新版申請書）正本連同相關資料寄回，並在文件上註明「身分證字號」、「聯絡電話」及加註「補件」後，將補件資料郵寄至「 104 台北市中山區中山北路二段
                                    50 號 6 樓　台北富邦商業銀行 信用卡處」。
                                </li>
                                <li>其他補件方式請見<a
                                        href="https://www.fubon.com/banking/faq/index.htm?default=%E4%BF%A1%E7%94%A8%E5%8D%A1%E8%A3%9C%E4%BB%B6"
                                        target="_blank">常見問題</a>。</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 注意事項mb -->
            <div class="section step2-section-mb mb">
				<!-- 新增財力證明 -->
				<a href="https://mkt.taipeifubon.com.tw/creditcard/costco/index.html#sec6" class="link" target="_blank">
					財力證明需要補件？懶人包看這裡＞
				</a>
                <div class="list">
                    <h3 class="active" onclick="openList(event)">注意事項<span class="active"><img
                                src="images/icon/arrow-down.svg" alt=""></span></h3>
                    <div class="item">
                        <p>感謝您申辦本行信用卡，如您尚需補件，請點選「 線上補件」，或依下述說明補件，我們將盡速為您處理。</p>
                        <p>注意事項：</p>
                        <ul>
                            <li>
                                線上補件：
                                <ul>
                                    <!-- 新增文字1 '，可分批上傳' -->
									<li>每個檔案上限 6M，每次上傳檔案總和上限 15M，可分批上傳。</li> 
									<li>補件檔案請務必清晰無反光，並勿加密檔案，以免補件失敗。</li>
									<!-- 新增文字2 '(待補資料若為財力證明類，請擇一提供，且文件須顯示本人姓名)' -->
									<li>請依分類【身份證明文件、個人相片、財力證明、基本資料及聯名團體相關資料、其他】逐項上傳補件資料，以利系統判斷是否補件完整。(待補資料若為財力證明類，請擇一提供，且文件須顯示本人姓名)</li>
									<!-- 新增文字3 '系統將於您點選~...' -->
									<li>系統將於您點選【確認上傳】後，進行資料傳送，並將於1~2小時內進行更新案件進度。</li>
									<!-- 新增文字4 '富邦Costco聯名卡~...' -->
									<li>富邦Costco聯名卡之會員相片補件僅能透過本行官網線上上傳，無法透過郵寄等件方式補件。</li>
                                </ul>
                            </li>
                            <li>
                                郵寄補件：<br>若您所缺之文件需徵提「補申請人之中文簽名」或「以舊版申請書進件」
                                ，請務必將申請書（或新版申請書）正本連同相關資料寄回，並在文件上註明「身分證字號」、「聯絡電話」及加註「補件」後，將補件資料郵寄至「 104 台北市中山區中山北路二段
                                50 號 6 樓　台北富邦商業銀行 信用卡處」。
                            </li>
                            <li>其他補件方式請見<a
                                    href="https://www.fubon.com/banking/faq/index.htm?default=%E4%BF%A1%E7%94%A8%E5%8D%A1%E8%A3%9C%E4%BB%B6"
                                    target="_blank">常見問題</a>。</li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- 補件表單 -->
            <div class="section upload" id="upBlock">
                <div class="upload-box">
                    <div class="label">
                        案件一待補文件
                    </div>
                    <form class="content" id="form-info">
                        <!-- 身份證明文件 -->
                        <div class="block id-block">
                            <div class="title">
                                <h3>身份證明文件<span onclick="openPopup('personal')"><img src="images/icon/info.svg"
                                            alt=""></span><span onclick="openPopup('personal')">詳細資訊</span></h3>
                                <p>檔案格式：JPG,JPEG,PNG,TIFF,PDF</p>
                            </div>
                            <div class="box">
                                <div class="item-block">
                                    <div class="item" id="id-block-1">
                                        <div class="subtitle">
                                            身份證明文件 1
                                        </div>
                                        <div class="item-box">
                                            <div class="upload-btn">
                                                <label for="">選擇檔案</label>
                                                <input type="file" id="id-block-1-input"
                                                    accept="image/png, image/jpeg, application/pdf,image/tiff"
                                                    onchange="handleFiles('id-block-1',this.files, event)">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="add-block" onclick="addItem('id-block')">
                                    <div class="icon">
                                        <img src="images/icon/plus.svg" alt="" class="plus-g">
                                        <img src="images/icon/plus-hover.svg" alt="" class="plus-w">
                                    </div>
                                    <p>新增</p>
                                </div>
                                <div class="agree-block">
                                    <input type="checkbox" name="" id="agree-id" value="">
                                    <label class="style-check" for="agree-id"></label>
                                    <label class="text-check" for="agree-id">若您同意於案件二、案件三共用本次上傳內容，請勾選此欄</label>
                                </div>
                            </div>
                        </div>
                        <!-- 個人相片 -->
                        <div class="block idPhoto-block">
                            <div class="title">
                                <h3>個人相片<span onclick="openPopup('photo')"><img src="images/icon/info.svg"
                                            alt=""></span><span onclick="openPopup('photo')">詳細資訊</span></h3>
                                <!-- 更新個人相片文字：檔案格式限JPG~...-->
                                <p>檔案格式限JPG、大小上限6MB，解析度300dpi。正面、脫帽、未戴有色眼鏡，並確保人像置中、臉部佔整張照片70%~80%。<br class="mb"></p>
                            </div>
                            <div class="box">
                                <div class="item-block">
                                    <div class="item">
                                        <div class="subtitle">
                                            個人相片
                                        </div>
                                        <div class="item-box upload-success">
                                            <div class="size">
                                            </div>
                                            <div class="status">
                                                上傳成功
                                                <span>
                                                    <img src="images/icon/checkmark.svg" alt="">
                                                </span>
                                            </div>
                                            <div class="delete-file" onclick="deleteFile(event, 'idPhoto-block')">
                                                刪除
                                            </div>
                                        </div>
                                        <div class="item-box upload-input">
                                            <div class="upload-btn" onclick="openPopup('uploadPhoto')">
                                                <label for="">選擇檔案</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="agree-block">
                                    <input type="checkbox" name="" id="agree-idPhoto" value="">
                                    <label class="style-check" for="agree-idPhoto"></label>
                                    <label class="text-check" for="agree-idPhoto">若您同意於案件二、案件三共用本次上傳內容，請勾選此欄</label>
                                </div>
                            </div>
                        </div>
                        <!-- 財力證明 -->
                        <div class="block financial-block">
                            <div class="title">
                                <h3>財力證明<span onclick="openPopup('financial')"><img src="images/icon/info.svg"
                                            alt=""></span><span onclick="openPopup('financial')">詳細資訊</span></h3>
                                <p>檔案格式：JPG,JPEG,PNG,TIFF,PDF</p>
                            </div>
                            <div class="box">
                                <div class="item-block">
                                    <div class="item" id="financial-block-1">
                                        <div class="delete-item" onclick="deleteItem(event, 'financial-block-1')">
                                            <img src="images/icon/minus.svg" alt="">
                                        </div>
                                        <div class="subtitle">
                                            財力證明 1
                                        </div>
                                        <div class="item-box">
                                            <div class="upload-btn">
                                                <label for="">選擇檔案</label>
                                                <input type="file" id="financial-block-1-input"
                                                    accept="image/png, image/jpeg, application/pdf,image/tiff"
                                                    onchange="handleFiles('financial-block-1',this.files, event)">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="add-block" onclick="addItem('financial-block')">
                                    <div class="icon">
                                        <img src="images/icon/plus.svg" alt="" class="plus-g">
                                        <img src="images/icon/plus-hover.svg" alt="" class="plus-w">
                                    </div>
                                    <p>新增</p>
                                </div>
                                <div class="agree-block">
                                    <input type="checkbox" name="" id="agree-financial" value="">
                                    <label class="style-check" for="agree-financial"></label>
                                    <label class="text-check" for="agree-financial">若您同意於案件二、案件三共用本次上傳內容，請勾選此欄</label>
                                </div>
                            </div>
                        </div>
                        <!-- 基本資料及聯名團體相關資料 -->
                        <div class="block group-block">
                            <div class="title">
                                <h3>基本資料及<br class="mb">聯名團體相關資料<span onclick="openPopup('group')"><img
                                            src="images/icon/info.svg" alt=""></span><span
                                        onclick="openPopup('group')">詳細資訊</span></h3>
                                <p>檔案格式：JPG,JPEG,PNG,TIFF,PDF</p>
                            </div>
                            <div class="box">
                                <div class="item-block">
                                    <div class="item" id="group-block-1">
                                        <div class="delete-item" onclick="deleteItem(event, 'group-block-1')">
                                            <img src="images/icon/minus.svg" alt="">
                                        </div>
                                        <div class="subtitle">
                                            基本資料及<br class="mb">聯名團體相關資料 1
                                        </div>
                                        <div class="item-box">
                                            <div class="upload-btn">
                                                <label for="">選擇檔案</label>
                                                <input type="file" id="group-block-1-input"
                                                    accept="image/png, image/jpeg, application/pdf,image/tiff"
                                                    onchange="handleFiles('group-block-1',this.files, event)">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="add-block" onclick="addItem('group-block')">
                                    <div class="icon">
                                        <img src="images/icon/plus.svg" alt="" class="plus-g">
                                        <img src="images/icon/plus-hover.svg" alt="" class="plus-w">
                                    </div>
                                    <p>新增</p>
                                </div>
                                <div class="agree-block">
                                    <input type="checkbox" name="" id="agree-group" value="">
                                    <label class="style-check" for="agree-group"></label>
                                    <label class="text-check" for="agree-group">若您同意於案件二、案件三共用本次上傳內容，請勾選此欄</label>
                                </div>
                            </div>
                        </div>
                        <!-- 其他 -->
                        <div class="block other-block">
                            <div class="title">
                                <h3>其他<span onclick="openPopup('other')"><img src="images/icon/info.svg"
                                            alt=""></span><span onclick="openPopup('other')">詳細資訊</span></h3>
                                <p>檔案格式：JPG,JPEG,PNG,TIFF,PDF</p>
                            </div>
                            <div class="box">
                                <div class="item-block">
                                    <div class="item" id="other-block-1">
                                        <div class="delete-item" onclick="deleteItem(event, 'other-block-1')">
                                            <img src="images/icon/minus.svg" alt="">
                                        </div>
                                        <div class="subtitle">
                                            其他 1
                                        </div>
                                        <div class="item-box">
                                            <div class="upload-btn">
                                                <label for="">選擇檔案</label>
                                                <input type="file" id="other-block-1-input"
                                                    accept="image/png, image/jpeg, application/pdf,image/tiff"
                                                    onchange="handleFiles('other-block-1',this.files, event)">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="add-block" onclick="addItem('other-block')">
                                    <div class="icon">
                                        <img src="images/icon/plus.svg" alt="" class="plus-g">
                                        <img src="images/icon/plus-hover.svg" alt="" class="plus-w">
                                    </div>
                                    <p>新增</p>
                                </div>
                                <div class="agree-block">
                                    <input type="checkbox" name="" id="agree-other" value="">
                                    <label class="style-check" for="agree-other"></label>
                                    <label class="text-check" for="agree-other">若您同意於案件二、案件三共用本次上傳內容，請勾選此欄</label>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <div class="total-size">
                    <span class="total">0</span> / 15MB
                </div>
                <div class="send-btn" onclick="submit()">
                    確認上傳
                </div>
            </div>
            <!-- 身份證明注意事項 -->
            <div class="popup" data-pop="personal">
                <div class="container">
                    <h3>詳細資訊</h3>
                    <div class="info-content">
                        <ul>
                            <li>身分證明待補文件請見申請進度說明，如：<br>申請人身分證正反面清晰影本。</li>
                            <li>補件檔案請務必清晰無反光，並請勿加密檔案，以免補件失敗。</li>
                        </ul>
                    </div>
                    <div class="understand" onclick="closePopup('personal')">
                        確認
                    </div>
                </div>
            </div>
            <!-- 個人相片注意事項 -->
            <div class="popup" data-pop="photo" id="photo">
                <div class="container">
                    <h3>詳細資訊</h3>
                    <ul>
                        <li>請上傳近年內2吋半身、正面、脫帽、未戴有色眼鏡相片，須清晰可辨識人貌五官且不得使用合成相片。</li>
                        <li>相片中臉部需佔整張相片面積的70~80%。</li>
                        <li>範例：</li>
                    </ul>
                    <div class="demo-pic">
                        <div class="demo-box">
                            <div class="pic">
                                <img src="images/photo1.png" alt="">
                            </div>
                            <p>正面清晰</p>
                            <div class="icon">
                                <img src="images/photo-correct.png" alt="">
                            </div>
                        </div>
                        <div class="demo-box">
                            <div class="pic">
                                <img src="images/photo2.png" alt="">
                            </div>
                            <p>無法辨識人臉</p>
                            <div class="icon">
                                <img src="images/photo-wrong.png" alt="">
                            </div>
                        </div>
                        <div class="demo-box">
                            <div class="pic">
                                <img src="images/photo3.png" alt="">
                            </div>
                            <p>無法辨識申請人</p>
                            <div class="icon">
                                <img src="images/photo-wrong.png" alt="">
                            </div>
                        </div>
                    </div>
                    <div class="understand" onclick="closePopup('photo')">
                        確認
                    </div>
                </div>
            </div>
            <!-- 上傳個人相片 -->
            <div class="popup" data-pop="uploadPhoto">
                <div class="container">
                    <div class="up-part1" id="up-part1">
                        <div class="close-btn" onclick="closePopup('uploadPhoto')"></div>
                        <h3>上傳個人相片</h3>
                        <div class="pic">
                            <img src="images/photo-frame.png" alt="">
                        </div>
                        <ul>
                            <li>Costco 會員請上傳近年內個人 2 吋半身、
                                正面、脫帽、未戴有色眼鏡，須清晰可辨識
                                人貌五官且不得使用合成相片，請參閱會員
                                相片規格範例。</li>
                            <li>相片中臉部需佔整張照片面積的 70~80%。</li>
                        </ul>
                        <div class="choose-btn">
                            <label for="upload_img">選擇個人相片</label>
                            <input type="file" id="upload_img" accept="image/jpeg">
                        </div>
                    </div>
                    <div class="up-part2 hide" id="up-part2">
                        <div class="pic demo" id="demo-basic"></div><!-- 裁切圖片區塊 -->
                        <div class="rotate" onclick="cropRotate(-90)">
                            <img src="images/icon/rotate.svg" alt="">
                        </div>
                        <div class="button">
                            <div class="btn cancel-btn" onclick="cancelUpload()">
                                取消
                            </div>
                            <div class="btn" id="crop-btn">
                                確定裁切上傳
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 財力證明注意事項 -->
            <div class="popup" data-pop="financial">
                <div class="container">
                    <h3>詳細資訊</h3>
                    <div class="content">
                        <p>以下財力證明請擇一提供：</p>
                        <table>
                            <tbody>
                                <tr>
                                    <td>薪資收入<br>族群</td>
                                    <td>
                                        <ul>
                                            <li>
                                                <span>扣繳憑單/所得清單</span><br>
                                                最新年度憑單/清單之完整頁面，本人為所得人
                                            </li>
                                            <li>
                                                <span>薪資單</span><br>
                                                最新發薪年月之完整頁面，本人為受薪員工
                                            </li>
                                            <li>
                                                <span>薪資轉帳存摺 (含網行銀對帳單)</span><br>
                                                最近月份撥薪明細之完整頁面、本人戶名及帳號頁
                                            </li>
                                            <li>
                                                <span>健保投保紀錄</span><br>
                                                一個月內查詢之完整頁面，須為本人投保於現職公司，不包括加保於工會/農會/漁會等及眷屬投保
                                                <br>
                                                *可於「健保快易通 APP」截圖<br>
                                                開啟 APP > 健保櫃台 > 個人各項查詢及設定 > 投保紀錄查詢 > 截圖存檔

                                            </li>
                                        </ul>
                                    </td>
                                </tr>
                                <tr>
                                    <td>持有<br>不動產</td>
                                    <td>
                                        <ul>
                                            <li>
                                                <span>房屋稅單/地價稅單</span>
                                                <br>
                                                最新年度稅單完整頁面，本人為納稅義務人
                                            </li>
                                            <li>
                                                <span>財產清單/土地謄本</span>
                                                <br>
                                                最新年度清單/謄本完整頁面，本人為所有人
                                            </li>
                                        </ul>
                                    </td>
                                </tr>
                                <tr>
                                    <td>存款餘額</td>
                                    <td>
                                        <ul class="disc">
                                            <li>
                                                <span>存款存摺 (含網行銀對帳單)</span><br>
                                                一個月內最新餘額明細之完整頁面、本人戶名及帳號頁
                                            </li>
                                        </ul>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="understand" onclick="closePopup('financial')">
                        確認
                    </div>
                </div>
            </div>
            <!-- 基本資料及聯名團體相關資料注意事項 -->
            <div class="popup" data-pop="group">
                <div class="container">
                    <h3>詳細資訊</h3>
                    <div class="info-content">
                        <ul>
                            <li>【基本資料及聯名團體相關資料】如：現居地址、電話等資料手寫拍照上傳，敬請依申請進度說明提供。</li>
                            <li>補件檔案請務必清晰無反光，並請勿加密檔案，以免補件失敗。</li>
                        </ul>
                    </div>
                    <div class="understand" onclick="closePopup('group')">
                        確認
                    </div>
                </div>
            </div>
            <!-- 其他注意事項 -->
            <div class="popup" data-pop="other">
                <div class="container">
                    <h3>詳細資訊</h3>
                    <div class="info-content">
                        <ul>
                            <li>待補資料非屬於【身份證明文件、個人相片、財力證明、基本資料及聯名團體相關資料】，請於【其他】欄位上傳。</li>
                            <li>補件檔案請務必清晰無反光，並請勿加密檔案，以免補件失敗。</li>
                        </ul>
                    </div>
                    <div class="understand" onclick="closePopup('other')">
                        確認
                    </div>
                </div>
            </div>
            <!-- 錯誤訊息popup -->
            <div class="popup" data-pop="error" id="error">
                <div class="container">
                    <h3>系統訊息</h3>
                    <p class="info">上傳檔案大小超過6MB/
                        總上傳檔案大小超過12MB
                        /檔案格式不符合/送出成功/送出失敗</p>
                    <div class="understand" onclick="closePopup('error')">
                        確認
                    </div>
                </div>
            </div>
            <!-- 成功訊息popup -->
            <div class="popup" data-pop="success" id="success">
                <div class="container">
                    <h3>成功</h3>
                    <p class="info">檔案已上傳成功，約3~5個工作天處理，敬請耐心等候，謝謝。</p>
                    <div class="understand" onclick="closePopup('success')">
                        確認
                    </div>
                </div>
            </div>
            <!-- 檔案上傳過度popup -->
            <div class="popup" data-pop="uploading" id="uploading">
                <div class="container">
                    <h3>提示</h3>
                    <p class="info">上傳中，請勿關閉視窗!</p>
                </div>
            </div>
            <!-- 系統錯誤訊息popup，回第一頁 -->
            <div class="popup" data-pop="system-error">
                <div class="container">
                    <h3>系統訊息</h3>
                    <p class="info">連線逾時，請重新登入查詢</p>
                    <div class="understand" onclick="closePopup('error', location.href='progress_check.html')">
                        確認
                    </div>
                </div>
            </div>
        </div>
        <div class="card-notice">
            <div class="content">
                <div class="box">
                    <h3>謹慎理財 信用無價</h3>
                </div>
                <div class="box">
                    <p>信用卡循環年利率：本行指數型房貸基準利率(I)+加碼利率(該加碼利率區間為0.62%~14.00%，基準日為108.1.1)；年利率上限為15%。 預借現金手續費：預借金額×2.5%。
                        其他費用請至<a href="https://www.fubon.com" target="_blank">https://www.fubon.com</a>查詢。</p>
                </div>
            </div>
        </div>
        <footer>
            <div class="content ">
                <p>© 台北富邦商業銀行股份有限公司</p>
                <p>建議瀏覽器版本：Edge、Chrome、Safari、FireFox 以上最新版本</p>
            </div>
        </footer>
    </div>
    <script type="text/javascript" src="js/vendors/jquery-3.6.0.min.js"></script>
    <script type="text/javascript" src="js/vendors/jquery-migrate-3.0.0.min.js"></script>
    <script type="text/javascript" src="js/vendors/croppie.min.js"></script>
    <script type="text/javascript" src="/config.js"></script>
    <script>
        const labelList = ['id-block', 'idPhoto-block', 'financial-block', 'group-block', 'other-block'];
        const finalList = {};
        const formData = {};
        const formDataSize = {};
        const isWareList = [];
        let chooseRef = '';
        let sumFile = 0;
        let otherCaseCode = [[], [], [], [], []];
        const uploadElseForm = [];

        inactivityTime();
        function inactivityTime() {
            var t;
            window.onload = resetTimer;
            // DOM Events
            window.onmousemove = resetTimer;
            window.onmousedown = resetTimer; // catches touchscreen presses
            window.onclick = resetTimer;     // catches touchpad clicks
            window.onchange = resetTimer;     // catches touchpad clicks
            window.onscroll = resetTimer;    // catches scrolling with arrow keys

            function logout() {
                openPopup('system-error');
            }

            function resetTimer() {
                clearTimeout(t);
                var sTimeout = 300000;
                t = setTimeout(logout, sTimeout);
            }
        };

        renewToken();
        function renewToken() {
            setInterval(() => {
                fetch(`${domain}/api/v1/renewToken`, {
                    method: 'POST',
                    headers: {
                        // 'Content-Type': 'application/json',
                        'Accept': 'application/json',
                        authorization: `Bearer ${sessionStorage.getItem('token')}`
                    },
                    mode: 'cors',
                })
                    .then(function (response) {
                        return response.json();
                    })
                    .then(function (data) {
                        if (data.code == '0000') {
                            sessionStorage.setItem('token', data.jwtToken);
                        }
                    })
                    .catch(function (error) {
                    });
            }, 60000);
        }

        window.onbeforeunload = function (e) {
            clearInterval(renewToken);
        };

        $(document).ready(function () {
            if (sessionStorage.getItem('customerData')) {
                const tableList = JSON.parse(sessionStorage.getItem('customerData')).customerRepeat;

                tableList.map((i) => {
                    i.furtherCode = [];
                    const targets = ['01', '02', '03', '04', '99'];
                    targets.map((j) => {
                        i.furtherCode.push({ id: j, show: j == '04' ? i.furtherDoc?.includes(j) && !i.furtherDoc?.includes('正卡補件中') : !!i.furtherDoc?.includes(j) });
                    })
                    if (Object.keys(finalList).includes(i.refNo)) {
                        finalList[i.refNo].crdType += `<br>${i.crdType}`;
                    } else {
                        finalList[i.refNo] = i;
                    }
                })

                Object.values(finalList).map((i, index) => {
                    if (i.isWare == 'Y') isWareList.push(index);
                    const tdPcList = `
                        <tr>
                            <td>
                                <p>${toChinese(index)}</p>
                            </td>
                            <td>
                                <p>${i.crdName}</p>
                            </td>
                            <td>
                                <p>${i.crdType}</p>
                            </td>
                            <td>
                                <p>${i.furtherResult}</p>
                                <ul style="${i.furtherResultDoc?.length == 0 ? 'display:none;' : ''}">
                                    ${i.furtherResultDoc.map((x) => { return '<li>' + x + '</li>' }).join('')}
                                </ul>
                            </td>
                            <td>
                                <a href="#upBlock" onclick="openCase('${i.refNo}',${index})" style="${i.isWare != 'Y' ? 'display:none;' : ''}">
                                    線上補件
                                    <span>
                                        <img src="images/icon/next-b.png" alt="" class="arrow-b">
                                        <img src="images/icon/next-w.png" alt="" class="arrow-w">
                                    </span>
                                </a>
                                <div class="mark" style="${i.furtherDocMsg == null || i.furtherDocMsg == '' ? 'display:none;' : ''}">
                                    <div class="icon">
                                        <img src="images/icon/warn-blue.svg" alt="">
                                    </div>
                                    <p>${i.furtherDocMsg}${i.furtherDocMsg == null ? 'hide' : ''}</p>
                                </div>
                            </td>
                        </tr>
                    `;
                    $('.step2-section-pc table').append(tdPcList);

                    const tdMbList = `
                        <div class="box">
                            <div class="title">
                                <h3>案件${toChinese(index)}</h3>
                            </div>
                            <table>
                                <tr>
                                    <td>
                                        <p>卡片種類</p>
                                    </td>
                                    <td>
                                        <p>${i.crdName}</p>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <p>卡別</p>
                                    </td>
                                    <td>
                                        <p>${i.crdType}</p>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <p>申請進度</p>
                                    </td>
                                    <td>
                                        <p>${i.furtherResult}</p>
                                        <ul style="${i.furtherResultDoc?.length == 0 ? 'display:none;' : ''}">
                                            ${i.furtherResultDoc.map((x) => { return '<li>' + x + '</li>' }).join('')}
                                        </ul>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <p>補件方式<br>
                                    </td>
                                    <td>
                                        <a href="#upBlock" onclick="openCase('${i.refNo}',${index})" style="${i.isWare != 'Y' ? 'display:none;' : ''}">
                                            線上補件
                                            <span>
                                                <img src="images/icon/next-b.png" alt="" class="arrow-b">
                                                <img src="images/icon/next-w.png" alt="" class="arrow-w">
                                            </span>
                                        </a>
                                        <div class="mark" style="${i.furtherDocMsg == null || i.furtherDocMsg == '' ? 'display:none;' : ''}">
                                            <div class="icon">
                                                <img src="images/icon/warn-blue.svg" alt="">
                                            </div>
                                            <p>${i.furtherDocMsg}${i.furtherDocMsg == null ? 'hide' : ''}</p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    `;
                    $('.step2-section-mb .list').before(tdMbList);
                })

                if (Object.keys(finalList).length == 1) $('.agree-block').css('display', 'none');

                $(".loading").fadeOut(350);
            } else {
                location.href = 'progress_check.html';
            }
        });

        function toChinese(n) {
            const digits = ['', '一', '二', '三', '四', '五', '六', '七', '八', '九'];
            positions = ['', '十', '百'];
            charArray = String(n + 1).split('');
            let result = '';
            let pervIsZeros = false;
            for (let i = 0; i < charArray.length; i++) {
                const ch = charArray[i];
                if (ch !== '0' && !pervIsZeros) {
                    result += digits[parseInt(ch)] + positions[charArray.length - i - 1];
                } else if (ch === '0') {
                    pervIsZeros = true;
                } else if (ch !== '0' && pervIsZeros) {
                    result += '' + digits[parseInt(ch)] + positions[charArray.length - i - 1];
                }
            }
            return (charArray.length == 2 && charArray[0] == '1') ? result.slice(1) : result;
        }

        function submit() {
            // 未選擇檔案
            if (Object.keys(formData).length == 0) {
                $('#error .info').text('請選擇欲上傳的檔案。');
                openPopup('error');
                return
            }
            $('#uploading .info').text(sumFile > 5000000 ? '上傳中，因檔案較大，敬請耐心等候，請勿關閉視窗!' : '上傳中，請勿關閉視窗!');
            openPopup('uploading');
            const agreeList = $('.agree-block').children('input');
            const agrees = [];
            let elseFormList = [];
            agreeList.map((x) => {
                if (agreeList[x].checked) elseFormList = [...elseFormList, ...otherCaseCode[x]];
                agreeList[x].checked ? agrees.push(agreeList[x].id.split('-')[1]) : '';
            })
            elseFormList = [...new Set(elseFormList)];

            elseFormList.map((i) => {
                const elseForm = new FormData;
                Object.keys(formData).forEach((key) => {
                    // 將同意共用的檔案轉成FormData
                    switch (key.split('-')[0]) {
                        case 'id': {
                            if (otherCaseCode[0].includes(i)) elseForm.append(key.split('-')[0], formData[key]);
                            break;
                        }
                        case 'idPhoto': {
                            if (otherCaseCode[1].includes(i)) elseForm.append(key.split('-')[0], formData[key]);
                            break;
                        }
                        case 'financial': {
                            if (otherCaseCode[2].includes(i)) elseForm.append(key.split('-')[0], formData[key]);
                            break;
                        }
                        case 'group': {
                            if (otherCaseCode[3].includes(i)) elseForm.append(key.split('-')[0], formData[key]);
                            break;
                        }
                        case 'other': {
                            if (otherCaseCode[4].includes(i)) elseForm.append(key.split('-')[0], formData[key]);
                            break;
                        }
                    }
                })
                uploadElseForm.push({ form: elseForm, refNo: i })
            })

            const form = new FormData;
            // 將選中的案件之所有上傳的檔案轉成FormData
            Object.keys(formData).forEach((key) => {
                form.append(key.split('-')[0], formData[key]);
            })

            fetch(`${domain}/api/v1/getServerTime`, {
                method: 'POST',
                headers: {
                    // 'Content-Type': 'application/json',
                    'Accept': 'application/json',
                    authorization: `Bearer ${sessionStorage.getItem('token')}`
                },
                mode: 'cors',
            })
                .then(function (response) {
                    return response.json();
                })
                .then(function (data) {
                    if (data.code == '0000') {
                        //上傳目前所選案件
                        upload(form, chooseRef, data.data.serverTime);
                    } else {
                        closePopup('uploading');
                        $('.popup .info').html(`${data.message}`);
                        openPopup('error');
                    }
                })
                .catch(function (error) {
                    closePopup('uploading');
                    $('.popup .info').html(error.error);
                    openPopup('error');
                });
        }

        function upload(form, refNo, timestamp) {
            form.append('CustomerId', JSON.parse(sessionStorage.getItem('formData')).custId);
            form.append('refNo', refNo);
            form.append('timestamp', timestamp);

            fetch(`${domain}/api/v1/upload`, {
                method: 'POST',
                headers: {
                    // 'Content-Type': 'multipart/form-data',
                    'Accept': 'application/json',
                    authorization: `Bearer ${sessionStorage.getItem('token')}`
                },
                mode: 'cors',
                body: form
            })
                .then(function (response) {
                    return response.json();
                })
                .then(function (data) {
                    if (data.code == '0000') {
                        if (uploadElseForm.length != 0) {
                            upload(uploadElseForm[0].form, uploadElseForm[0].refNo, timestamp);
                            uploadElseForm.splice(0, 1);
                        } else {
                            closePopup('uploading');
                            openPopup('success');
                        }
                    } else {
                        closePopup('uploading');
                        if (data.code == '1003') {
                            openPopup('system-error');
                        } else {
                            $('#error .info').html(`${data.message}`);
                            openPopup('error');
                        }
                    }
                    clearForm();
                })
                .catch(function (error) {
                    closePopup('uploading');
                    $('#error .info').html(`很抱歉，檔案暫時未能送出，請稍後再試。或洽客服專線 02-8751-1313。`);
                    openPopup('error');
                });
        }

        function reSize(bytes) {
            var s = ['Bytes', 'KB', 'MB'];
            var e = Math.floor(Math.log(bytes) / Math.log(1000));
            return (bytes / Math.pow(1000, Math.floor(e))).toFixed(2) + ' ' + s[e];
        }

        function handleFiles(key, data, event) {
            if (data[0].size > 6000000) {
                $('#error .info').text('上傳的附件文件請勿超過 6MB。');
                $(`#${key}-input`).val('')
                openPopup('error');
            } else if (sumFile + data[0].size > 15000000) {
                $('#error .info').text('上傳的總附件文件請勿超過 15MB。');
                $(`#${key}-input`).val('')
                openPopup('error');
            } else {
                const eventPath = event.path || (event.composedPath && event.composedPath());
                addFiles(key, data, eventPath);
            }
        }

        function addFiles(key, data, eventPath) {
            formData[key] = data[0];
            formDataSize[key] = data[0].size;
            //選擇檔案按鈕移除
            $(eventPath[2]).remove();
            const successBlock = `                                        
                <div class="item-box upload-success active">
                    <div class="size">${reSize(data[0].size)}</div>
                    <div class="status">
                        上傳成功
                        <span>
                            <img src="images/icon/checkmark.svg" alt="">
                        </span>
                    </div>
                    <div class="delete-file" onclick="deleteFile(event,'${key}')">
                        刪除
                    </div>
                </div>
            `;
            //成功上傳區塊顯示
            $(eventPath[3]).append(successBlock);
            displayTotal();
        }

        function displayTotal() {
            const values = Object.values(formDataSize);
            const sum = values.reduce((accumulator, value) => {
                return accumulator + value;
            }, 0);
            sumFile = sum;
            $('.total-size .total').text(sum ? reSize(sum) : '0');
        }

        // 新增欄位
        function addItem(blockName) {
            let length = $(`.${blockName} .item`).length;
            const time = new Date().getTime();
            const title = blockName == 'id-block' ? '身份證明文件' : blockName == 'financial-block' ? '財力證明' : blockName == 'group-block' ? '基本資料及<br class="mb">聯名團體相關資料' : '其他';
            if (blockName == 'id-block' ? length < 2 : length < 5) {
                let newItem = `
                    <div class="item" id="${blockName}-${time}">
                        <div class="delete-item" onclick="deleteItem(event,'${blockName}-${time}')">
                            <img src="images/icon/minus.svg" alt="">
                        </div>
                        <div class="subtitle">${title} ${length + 1}</div>
                        <div class="item-box">
                            <div class="upload-btn">
                                <label for="">選擇檔案</label>
                                <input type="file" id="${blockName}-${time}-input"
                                    accept="image/png, image/jpeg, application/pdf,image/tiff"
                                    onchange="handleFiles('${blockName}-${time}',this.files, event)">
                            </div>
                        </div>
                    </div>
                `;
                $(`.${blockName} .item-block`).append(newItem);
            }
            if (blockName == 'id-block' ? length + 1 == 2 : length + 1 == 5) {
                $(`.${blockName} .add-block`).addClass('hide');
            }
        }

        // 刪除檔案
        function deleteFile(event, key, path) {
            if (key == 'idPhoto-block') {
                //成功上傳區塊移除
                $(".idPhoto-block .upload-success").removeClass('active');
                $(".idPhoto-block .upload-input").fadeIn();
                cancelUpload();
            } else {
                const eventPath = event.path || (event.composedPath && event.composedPath());
                $(event !== '' ? eventPath[1] : $(path).children('.item-box')).remove();
                const inputBlock = `
                    <div class="item-box">
                        <div class="upload-btn">
                            <label for="">選擇檔案</label>
                            <input type="file" id="${key}-input"
                                accept="image/png, image/jpeg, application/pdf,image/tiff"
                                onchange="handleFiles('${key}',this.files, event)">
                        </div>
                    </div>
                `;
                $(event !== '' ? eventPath[2] : $(path)).append(inputBlock);
            }
            delete formData[key];
            delete formDataSize[key];

            displayTotal();
        }

        // 刪除欄位
        function deleteItem(event, key, path, label) {
            const eventPath = event.path || (event.composedPath && event.composedPath());
            $(event !== '' ? eventPath[2] : path).remove();
            const className = event !== '' ? $(eventPath[5]).attr('class').split(' ')[1] : label;
            if ($(`.${className} .add-block`).hasClass('hide')) {
                $(`.${className} .add-block`).removeClass('hide');
            }
            const blockLength = $(`.${className} .box .item-block`).children().length;
            if (blockLength > 0) {
                for (let i = 0; i < blockLength; i++) {
                    const id = $($(`.${className} .box .item-block`).children()[i]).attr('id');
                    const origin = $(`#${id} .subtitle`).text().trim();
                    const newSubtitle = origin.slice(0, -1) + ' ' + (i + 1);
                    $(`#${id} .subtitle`).text(newSubtitle);
                }
            }
            delete formData[key];
            delete formDataSize[key];

            displayTotal();
        }

        // 打開補件區塊
        function openCase(refNo, index) {
            if (chooseRef !== '' && chooseRef !== refNo) clearForm();
            chooseRef = refNo;
            $('.upload').fadeIn();
            const standard = finalList[refNo].furtherCode;
            let otherCase = ['', '', '', '', ''];
            otherCaseCode = [[], [], [], [], []]
            Object.values(finalList).map((i, index) => {
                if ((i.refNo != refNo) && i.isWare == 'Y') {
                    i.furtherCode.map((j, jIndex) => {
                        if (j.show == standard[jIndex].show && standard[jIndex].show) {
                            otherCase[jIndex] += `案件${toChinese(index)}、`;
                            otherCaseCode[jIndex].push(i.refNo)
                        }
                    })
                }
            })

            $('.agree-block .text-check').map((x) => {
                if (otherCase[x] !== '') {
                    $($('.agree-block .text-check')[x]).text(`若您同意於${otherCase[x].slice(0, -1)}共用本次上傳內容，請勾選此欄`);
                    $($('.agree-block')[x]).show()
                } else {
                    $($('.agree-block')[x]).hide()
                }
            })

            finalList[refNo].furtherCode.map((x, index) => {
                $(`.${labelList[index]}`).css('display', x.show ? 'block' : 'none');
            });
            $('.upload-box .label').text(`案件${toChinese(index)}待補文件`);
        }

        function clearForm() {
            labelList.map((x) => {
                const children = $(`.${x} .item-block`).children();
                if (x == 'idPhoto-block') {
                    deleteFile('', x);
                } else if (children.length == 1) {
                    deleteFile('', $(children).attr('id'), $(children));
                } else if (children.length > 1) {
                    deleteFile('', $(children[0]).attr('id'), $(children[0]));
                    for (let i = 1; i < children.length; i++) {
                        deleteItem('', $($(children)[i]).attr('id'), $(children)[i], x);
                    }
                } else if (children.length == 0) {
                    addItem(x);
                }

            })

            for (let i = 0; i < 5; i++) {
                $('.agree-block').children('input')[i].checked = false;
            }
        }

        // 打開注意事項
        function openList(event) {
            let actived = event.currentTarget;
            if ($(actived).hasClass('active')) {
                $(actived).removeClass('active');
                $(actived).parents().children('.item').slideUp();
                $('.list h3 span').removeClass('active');
            } else {
                $(actived).addClass('active');
                $(actived).parents().children('.item').slideDown();
                $('.list h3 span').addClass('active');
            }
        }

        // 裁切圖片
        let $uploadCrop,
            oldImg = new Image(),
            file, oldImgDataUrl;

        function readFile(input) {
            if (input.files && input.files[0]) {
                file = input.files[0];
                let reader = new FileReader();
                reader.onload = function (e) {
                    oldImgDataUrl = e.target.result;
                    oldImg.src = oldImgDataUrl;
                    $uploadCrop.croppie('bind', {
                        url: oldImgDataUrl
                    }).then(function () {
                        console.log('bind complete');
                    });
                }
                reader.readAsDataURL(file);
            }
            else {
                console.log(`Sorry - you're browser doesn't support the FileReader API`);
            }
        }

        $uploadCrop = $('#demo-basic').croppie({
            viewport: {
                width: 177,
                height: 200,
                type: 'square',
            },
            enableExif: true,
            enableOrientation: true
        });

        function cropRotate(deg) {
            $uploadCrop.croppie('rotate', parseInt(deg));
        }

        // 個人相片 取消按鈕
        function cancelUpload() {
            $('#photo .popup').fadeOut();
            $('.up-part2').addClass('hide');
            $('.up-part1').removeClass('hide');
            $('#upload_img').val('')
        }

        $('#upload_img').on('change', function () {
            $('.up-part1').addClass('hide');
            $('.up-part2').removeClass('hide');
            readFile(this);
        });

        $('#crop-btn').on('click', function () {
            $uploadCrop.croppie('result', {
                type: 'canvas',
                size: { width: 177, height: 200 },
                format: 'jpeg'
            }).then(function (res) {
                let formatRes = changeDpiDataUrl(res, 300);
                const croppieFile = dataURLtoFile(formatRes, 'croppie.jpeg');

                closePopup('uploadPhoto');
                formData['idPhoto-block'] = croppieFile;
                formDataSize['idPhoto-block'] = croppieFile.size;
                displayTotal();
                //成功上傳區塊顯示
                $('.idPhoto-block .upload-success').addClass('active');
                //選擇檔案按鈕隱藏
                $('.idPhoto-block .upload-input').fadeOut();
                $('.idPhoto-block .upload-success .size').text(reSize(croppieFile.size));
            });
        });

        function dataURLtoFile(dataurl, filename) {

            var arr = dataurl.split(','),
                mime = arr[0].match(/:(.*?);/)[1],
                bstr = atob(arr[1]),
                n = bstr.length,
                u8arr = new Uint8Array(n);

            while (n--) {
                u8arr[n] = bstr.charCodeAt(n);
            }

            return new File([u8arr], filename, { type: mime });
        }

        function openPopup(target) {
            $('.popup[data-pop="' + target + '"]').fadeIn();
        }

        function closePopup(target, callback) {
            $('.popup[data-pop="' + target + '"]').fadeOut();
            if (typeof callback == 'function') {
                callback();
            }
        }

        const JPEG = 'image/jpeg';
        function changeDpiDataUrl(base64Image, dpi) {
            const dataSplitted = base64Image.split(',');
            const format = dataSplitted[0];
            const body = dataSplitted[1];
            let type;
            let headerLength;
            let overwritepHYs = false;
            if (format.indexOf(JPEG) !== -1) {
                type = JPEG;
                headerLength = 18 / 3 * 4;
            }
            // 33 bytes are ok for pngs and jpegs
            // to contain the information.
            const stringHeader = body.substring(0, headerLength);
            const restOfData = body.substring(headerLength);
            const headerBytes = atob(stringHeader);
            const dataArray = new Uint8Array(headerBytes.length);
            for (let i = 0; i < dataArray.length; i++) {
                dataArray[i] = headerBytes.charCodeAt(i);
            }
            const finalArray = changeDpiOnArray(dataArray, dpi, type, overwritepHYs);
            const base64Header = btoa(String.fromCharCode(...finalArray));
            return [format, ',', base64Header, restOfData].join('');
        }

        function changeDpiOnArray(dataArray, dpi, format, overwritepHYs) {
            if (format === JPEG) {
                dataArray[13] = 1; // 1 pixel per inch or 2 pixel per cm
                dataArray[14] = dpi >> 8; // dpiX high byte
                dataArray[15] = dpi & 0xff; // dpiX low byte
                dataArray[16] = dpi >> 8; // dpiY high byte
                dataArray[17] = dpi & 0xff; // dpiY low byte
                return dataArray;
            }
        }
    </script>
</body>

</html>